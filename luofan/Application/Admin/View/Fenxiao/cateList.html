<include file="Public:head"/>
<link rel="stylesheet" href="__JqColor__/css/colpick.css" type="text/css"/>
<!-- 颜色选择器插件 -->
<style>
.btn-success {
	margin-top: 12px;
}
.formitems #addimage1 {
	width: 80px;
	height: 56px;
	padding: 0px;
	position: absolute;
	top: 0px;
	left: 0px;
	z-index: 10;
	cursor: pointer;
	opacity: 0;
}
.formitems #addimage2 {
	width: 80px;
	height: 56px;
	padding: 0px;
	position: absolute;
	top: 0px;
	left: 0px;
	z-index: 10;
	cursor: pointer;
	opacity: 0;
}
.formitems #editimage1 {
	width: 80px;
	height: 56px;
	padding: 0px;
	position: absolute;
	top: 0px;
	left: 0px;
	z-index: 10;
	cursor: pointer;
	opacity: 0;
}
.formitems #editimage2 {
	width: 80px;
	height: 56px;
	padding: 0px;
	position: absolute;
	top: 0px;
	left: 0px;
	z-index: 10;
	cursor: pointer;
	opacity: 0;
}
</style>
<div class="container">
<div class="inner clearfix"> <include file="Public:left"/> 
  <!-- end content-left -->
  
  <div class="content-right fl">
    <h1 class="content-right-title">产品分类列表</h1>
    <!--<div class="alert alert-info disable-del">
      <h4>提示</h4>
      删除分类会删除分类下面所有的产品 <a href="javascript:;" class="alert-delete" title="隐藏"> <i class="gicon-remove"></i></a></div>-->
    <form action="" method="post">
      <div class="clearfix"> <a href="javascript:;" class="btn btn-success fl BtnAddClass">添加分类</a> 
        
        <!--<div class="tables-searchbox fr">
                        <input type="text" placeholder="分类名称" class="input" name="class_name" value="">
                        <button class="btn"><i class="gicon-search"></i>查询</button>
                    </div>--> 
      </div>
    </form>
    <table class="wxtables mgt15">
      <colgroup>
      <col width="2%">
      <col width="5%">
      <col width="20%">
      <!-- <col width="10%"> -->
      <col width="15%">
      <col width="20%">
      <col width="38%">
      </colgroup>
      <thead>
        <tr>
          <td><i class="icon_check"></i></td>
          <td>id</td>
          <td>分类名称</td>
          <!-- <td>图标</td> --> 
          <!--<td style="text-align:center">显隐操作</td>-->
          <td>排序</td>
          <td >创建时间</td>
          <td class="center">操作</td>
        </tr>
      </thead>
      <tbody>
        <foreach name="cache" item="vo" >
          <tr>
            <td class="center"><input type="checkbox" class="checkbox table-ckbs" data-id="9788"></td>
            <td>{$vo.id}</td>
            <td>{$vo.classname}</td>
            <if condition="$vo.pic eq null"> 
              <!-- <td><img src="/Uploads/Picture/uploads/20170221/58aba2a4c73e8.png" width="30" alt="" style="background-color:{$vo['color']};"></td>
 -->
              <else/>
              <!-- <td><img src="{$vo.pic}" width="30" alt="" style="background-color:{$vo['color']};"></td> --> 
            </if>
            <td>{$vo.sort}</td>
            <td>{$vo.create_at|date="Y-m-d H:i:s",###}</td>
            <td class="center"><a href="javascript:void(0);" class="btn btn-primary j-editClass" title="编辑" data-id="{$vo.id}" data-describe1="{$vo.describe1}" data-describe2="{$vo.describe2}"data-describe3="{$vo.describe3}"data-describe4="{$vo.describe4}" data-pic="{$vo.pic}" data-title="{$vo.classname}" data-renk="{$vo.sort}" data-color="{$vo.color}" data-pic1="{$vo.pic1}" data-pic1="{$vo.pic1}" data-pic2="{$vo.pic2}" data-recommend="{$vo.is_recommend}">编辑</a> <!--a href="{:U('/Admin/Goods/delCate/id')}/{$vo.id}" class="btn btn-warning j-delClass" title="删除" onclick="return confirm('确定要删除吗？')" data-id="{$vo.id}">删除</a--> 
              <!-- <a href="javascript:;" class="btn btn-warning j-able" data-able="enable" title="禁用" data-id="9788">禁用</a>
                          --></td>
          </tr>
          <foreach name="vo.data" item="vo1" >
            <tr>
              <td class="center"><input type="checkbox" class="checkbox table-ckbs" data-id="9788"></td>
              <td>{$vo1.id}</td>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;|--{$vo1.classname}</td>
              <!-- <td><img src="{$vo1.pic}" width="30" alt=""></td> -->
              <td>{$vo1.sort}</td>
              <td>{$vo1.create_at|date="Y-m-d H:i:s",###}</td>
              <td class="center"><a href="javascript:void(0);" class="btn btn-primary j-editClass" title="编辑" data-id="{$vo1.id}" data-pic="{$vo1.pic}" data-describe1="{$vo1.describe1}"data-describe2="{$vo1.describe2}"data-describe3="{$vo1.describe3}"data-describe4="{$vo1.describe4}" data-fid="{$vo1.pid}" data-title="{$vo1.classname}" data-renk="{$vo1.sort}" data-color="{$vo1.color}" data-pic1="{$vo1.pic1}" data-pic2="{$vo1.pic2}">编辑</a> <a href="{:U('/Admin/Goods/delCate/id')}/{$vo1.id}" class="btn btn-warning j-delClass" title="删除" onclick="return confirm('确定要删除吗？')" data-id="{$vo1.id}">删除</a> 
                <!-- <a href="javascript:;" class="btn btn-warning j-able" data-able="enable" title="禁用" data-id="9788">禁用</a>
                          --></td>
            </tr>
          </foreach>
        </foreach>
      </tbody>
    </table>
    <!-- end wxtables -->
    <div class="tables-btmctrl clearfix">
      <div class="fl"> <a href="javascript:;" class="btn btn-primary btn_table_selectAll">全选</a> <a href="javascript:;" class="btn btn-primary btn_table_Cancle">取消</a> 
        <!--<a href="javascript;" class="btn btn-primary btn_table_delAll">批量删除</a></div>-->
        <div class="fr"> 
          <!--<div class="paginate">-->
          
          <div class="pages"> 
            <!--</div>--> 
            {$page} </div>
          <!-- end paginate --> 
        </div>
      </div>
      <!-- end tables-btmctrl --> 
    </div>
    <!-- end content-right --> 
  </div>
</div>
<!-- end container --> 
<include file="Public:foot"/>
<div id="albums-overlay" class="disshow"></div>
<div class="jbox addfenlei disshow" style="height:auto;">
  <div class="jbox-title">
    <div class="jbox-title-txt">添加分类</div>
    <a href="javascript:;" class="jbox-close cancle"></a></div>
  <div class="jbox-container" style="height: auto;">
    <div class="formitems">
      <label class="fi-name"><span class="colorRed">*</span>分类名称：</label>
      <div class="form-controls">
        <input type="text" class="input classname" name="classname" >
        <span class="fi-help-text"></span> </div>
    </div>
    <!--       <div class="formitems">
          <label class="fi-name"><span class="colorRed"></span>选择背景色：</label>
          <div class="form-controls">
                <input type="text" class="input color" name="color" id="color">
              <div id="picker" style="display: none;">
              </div>

              <span class="fi-help-text"></span> </div>
      </div> -->
    <div class="formitems">
      <label class="fi-name"><span class="colorRed"></span>上级分类：</label>
      <div class="form-controls">
        <select name='fid' style='padding:5px;border: 1px solid #ccc;width:182px' id='fid'>
          <option value="0">--顶级分类--</option>
          <foreach name="cate" item="vo" >
            <option value="{$vo.id}">{$vo.classname}</option>
          </foreach>
        </select>
        <span class="fi-help-text"></span> </div>
    </div>
    
    <!-- <div class="formitems" style=" height:60px;">
        <label class="fi-name"><span class="colorRed"></span>上传首页展示图片：</label>
        <div class="form-controls images">
            <div class="showimg"></div>
            <div class="imagesadd">+</div>
            <input type="file" accept="image/jpg,image/jpeg,image/png,image/svg" class="input sort" name="serial" id="addimage" >
            <div class="progress">
                <div class="bar"></div>
            </div>
            <span class="fi-help-text" style="left:85px; position:absolute; top:40px; width:150px; height:20px;">建议大小（宽50高50）</span>
 		    </div>
  </div>

 <div class="formitems" style=" height:60px;">
        <label class="fi-name"><span class="colorRed"></span>上传分类列表图片1：</label>
        <div class="form-controls images">
            <div class="showimg1" style="position: relative;z-index: 9;"></div>
            <div class="imagesadd">+</div>
            <input type="file" accept="image/jpg,image/jpeg,image/png" class="input sort" name="serial" id="addimage1" >
            <div class="progress">
                <div class="bar"></div>
            </div>
            <span class="fi-help-text" style="left:85px; position:absolute; top:40px; width:150px; height:20px;">建议大小（宽50高50）</span>
        </div>
  </div>

  <div class="formitems" style=" height:60px;">
        <label class="fi-name"><span class="colorRed"></span>上传分类列表图片2：</label>
        <div class="form-controls images">
            <div class="showimg2" style="position: relative;z-index: 9;"></div>
            <div class="imagesadd">+</div>
            <input type="file" accept="image/jpg,image/jpeg,image/png" class="input sort" name="serial" id="addimage2" >
            <div class="progress">
                <div class="bar"></div>
            </div>
            <span class="fi-help-text" style="left:85px; position:absolute; top:40px; width:150px; height:20px;">建议大小（宽50高50）</span>
        </div>
  </div> -->
    
    <div class="formitems">
      <label class="fi-name"><span class="colorRed"></span>分类排序：</label>
      <div class="form-controls">
        <input type="text" class="input" id="addsort" name="serial" >
        <span class="fi-help-text"></span> </div>
    </div>
  </div>
  <div class="jbox-buttons"><a href="javascript:void(0);" class="jbox-buttons-ok btn btn-primary" id="addcategory">确定</a><a
            href="javascript:void (0);" class="jbox-buttons-ok btn cancle">取消</a></div>
</div>
<div class="jbox editfenlei disshow" style="height:auto;">
  <div class="jbox-title">
    <div class="jbox-title-txt">修改分类</div>
    <a href="javascript:;" class="jbox-close cancle"></a></div>
  <div class="jbox-container" style="height: auto;">
    <div class="formitems">
      <label class="fi-name"><span class="colorRed">*</span>分类名称：</label>
      <div class="form-controls">
        <input type="text" class="input classname" name="classname" id="editclassname">
        <span class="fi-help-text"></span> </div>
    </div>
    
    <!--  <div class="formitems">
          <label class="fi-name"><span class="colorRed"></span>选择背景色：</label>
          <div class="form-controls">
                <input type="text" class="input color1" name="color1" id="color1">
              <div id="picker1" style="display: none;">
              </div>
              <span class="fi-help-text"></span> </div>
      </div>
 -->
    
    <div class="formitems">
      <label class="fi-name"><span class="colorRed"></span>上级分类：</label>
      <div class="form-controls">
        <select name='fid' style='padding:5px;border: 1px solid #ccc;width:182px' id='editfid'>
          <option value="0">--顶级分类--</option>
          <foreach name="cate" item="vo" >
            <option value="{$vo.id}">{$vo.classname}</option>
          </foreach>
        </select>
        <span class="fi-help-text"></span> </div>
    </div>
    
    <!-- 	   <div class="formitems" style=" height:60px;">
        <label class="fi-name"><span class="colorRed"></span>上传首页展示图片：</label>
        <div class="form-controls images">
            <div class="showimg showimgedit"></div>
            <div class="imagesadd">+</div>
            <input type="file"  accept="image/jpg,image/jpeg,image/png" class="input sort" name="serial" id="editimage" >
            <div class="progress">
                <div class="bar"></div>
            </div>
            <span class="fi-help-text" style="left:85px; position:absolute; top:40px; width:150px; height:20px;">建议大小（宽50高50）</span>
 		   </div>
    </div>

    <div class="formitems" style=" height:60px;">
        <label class="fi-name"><span class="colorRed"></span>上传分类列表图片1：</label>
        <div class="form-controls images">
            <div class="showimg showimgedit1" style="    position: relative;
    z-index: 9;"></div>
            <div class="imagesadd">+</div>
            <input type="file" accept="image/jpg,image/jpeg,image/png" class="input sort" name="serial" id="editimage1" >
            <div class="progress">
                <div class="bar"></div>
            </div>
            <span class="fi-help-text" style="left:85px; position:absolute; top:40px; width:150px; height:20px;">建议大小（宽50高50）</span>
        </div>
  </div>

  <div class="formitems" style=" height:60px;">
        <label class="fi-name"><span class="colorRed"></span>上传分类列表图片2：</label>
        <div class="form-controls images">
            <div class="showimg showimgedit2" style="    position: relative;
    z-index: 9;"></div>
            <div class="imagesadd">+</div>
            <input type="file" accept="image/jpg,image/jpeg,image/png" class="input sort" name="serial" id="editimage2" >
            <div class="progress">
                <div class="bar"></div>
            </div>
            <span class="fi-help-text" style="left:85px; position:absolute; top:40px; width:150px; height:20px;">建议大小（宽50高50）</span>
        </div>
  </div> -->
    
    <div class="formitems">
      <label class="fi-name"><span class="colorRed"></span>分类排序：</label>
      <div class="form-controls">
        <input type="text" class="input sort" name="serial" id="editsort" >
        <input type="hidden" class="input sort" name="serial" id="categoryid" >
        <span class="fi-help-text"></span> </div>
    </div>
  </div>
  <div class="jbox-buttons"><a href="javascript:void(0);" class="jbox-buttons-ok btn btn-primary" id="editcategory">确定</a><a
            href="javascript:;" class="jbox-buttons-ok btn cancle">取消</a></div>
</div>
<script type="text/javascript" src="__JS__/jquery-form.js"></script> 
<script src="__JqColor__/js/colpick.js" type="text/javascript"></script> 
<script type="text/javascript">
    $(".cancle").click(function(){
        $(this).parent().parent('.jbox').hide();
        $('#albums-overlay').hide();
    })

	$(function () {
		var progress = $(".img");
		var bar = $('.bar') ;
		var percent = $('.percent');
		var progress = $('.progress');
		$("#addimage").wrap("<form id='myupload' action='{:U('/Admin/Index/addImage')}' method='post' enctype='multipart/form-data'></form>");
		$("#addimage").change(function(){ //选择文件
			$("#myupload").ajaxSubmit({
				dataType:  'json', //数据格式为json
				beforeSend: function() { //开始上传
					progress.show(); //显示进度条
					var percentVal = '0%';
					bar.width(percentVal);
					percent.html(percentVal);
				},
				uploadProgress: function(event, position, total, percentComplete) {
					var percentVal = percentComplete + '%'; //获得进度
					bar.width(percentVal); //上传进度条宽度变宽
					percent.html(percentVal); //显示上传进度百分比
				},
				success: function(data) { //成功
					var img = '<img src="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'" width="80" height="56" style="margin-top:-28px;"><input type="hidden" name="pic" id="addpic" value="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'"></input>';
					$('.showimg').html(img);
					$("#addimage").val('');
					progress.hide();
				},
				error:function(xhr){ //上传失败
					//console.log(xhr.status)
				}
			});
		});
	});


	$(function () {
		var progress = $(".img");
		var bar = $('.bar') ;
		var percent = $('.percent');
		var progress = $('.progress');
		$("#editimage").wrap("<form id='myupload1' action='{:U('/Admin/Index/addImage')}' method='post' enctype='multipart/form-data'></form>");
		$("#editimage").change(function(){ //选择文件
			$("#myupload1").ajaxSubmit({
				dataType:  'json', //数据格式为json
				beforeSend: function() { //开始上传
					progress.show(); //显示进度条
					var percentVal = '0%';
					bar.width(percentVal);
					percent.html(percentVal);
				},
				uploadProgress: function(event, position, total, percentComplete) {
					var percentVal = percentComplete + '%'; //获得进度
					bar.width(percentVal); //上传进度条宽度变宽
					percent.html(percentVal); //显示上传进度百分比
				},
				success: function(data) { //成功
					var img = '<img src="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'" width="80" height="56" style="margin-top:-28px;"><input type="hidden" name="pic" id="editpic" value="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'"></input>';
					$('.showimgedit').html(img);
					$("#editimage").val('');
					progress.hide();
				},
				error:function(xhr){ //上传失败
					//console.log(xhr.status)
				}
			});
		});
	});

$(function () {
    var progress = $(".img");
    var bar = $('.bar') ;
    var percent = $('.percent');
    var progress = $('.progress');
    $("#addimage1").wrap("<form id='myupload2' action='{:U('/Admin/Index/addImage')}' method='post' enctype='multipart/form-data'></form>");
    $("#addimage1").change(function(){ //选择文件
      $("#myupload2").ajaxSubmit({
        dataType:  'json', //数据格式为json
        beforeSend: function() { //开始上传
          progress.show(); //显示进度条
          var percentVal = '0%';
          bar.width(percentVal);
          percent.html(percentVal);
        },
        uploadProgress: function(event, position, total, percentComplete) {
          var percentVal = percentComplete + '%'; //获得进度
          bar.width(percentVal); //上传进度条宽度变宽
          percent.html(percentVal); //显示上传进度百分比
        },
        success: function(data) { //成功
          var img = '<img src="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'" width="80" height="56" style="margin-top:-28px;"><input type="hidden" name="pic1" id="addpic1" value="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'"></input>';
          $('.showimg1').html(img);
          $("#addimage1").val('');
          progress.hide();
        },
        error:function(xhr){ //上传失败
          //console.log(xhr.status)
        }
      });
    });
  });

$(function () {
    var progress = $(".img");
    var bar = $('.bar') ;
    var percent = $('.percent');
    var progress = $('.progress');
    $("#editimage1").wrap("<form id='myupload4' action='{:U('/Admin/Index/addImage')}' method='post' enctype='multipart/form-data'></form>");
    $("#editimage1").change(function(){ //选择文件
      $("#myupload4").ajaxSubmit({
        dataType:  'json', //数据格式为json
        beforeSend: function() { //开始上传
          progress.show(); //显示进度条
          var percentVal = '0%';
          bar.width(percentVal);
          percent.html(percentVal);
        },
        uploadProgress: function(event, position, total, percentComplete) {
          var percentVal = percentComplete + '%'; //获得进度
          bar.width(percentVal); //上传进度条宽度变宽
          percent.html(percentVal); //显示上传进度百分比
        },
        success: function(data) { //成功
          var img = '<img src="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'" width="80" height="56" style="margin-top:-28px;"><input type="hidden" name="pic1" id="editpic1" value="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'"></input>';
          $('.showimgedit1').html(img);
          $("#editimage1").val('');
          progress.hide();
        },
        error:function(xhr){ //上传失败
          //console.log(xhr.status)
        }
      });
    });
  });

  $(function () {
    var progress = $(".img");
    var bar = $('.bar') ;
    var percent = $('.percent');
    var progress = $('.progress');
    $("#addimage2").wrap("<form id='myupload5' action='{:U('/Admin/Index/addImage')}' method='post' enctype='multipart/form-data'></form>");
    $("#addimage2").change(function(){ //选择文件
      $("#myupload5").ajaxSubmit({
        dataType:  'json', //数据格式为json
        beforeSend: function() { //开始上传
          progress.show(); //显示进度条
          var percentVal = '0%';
          bar.width(percentVal);
          percent.html(percentVal);
        },
        uploadProgress: function(event, position, total, percentComplete) {
          var percentVal = percentComplete + '%'; //获得进度
          bar.width(percentVal); //上传进度条宽度变宽
          percent.html(percentVal); //显示上传进度百分比
        },
        success: function(data) { //成功
          var img = '<img src="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'" width="80" height="56" style="margin-top:-28px;"><input type="hidden" name="pic2" id="addpic2" value="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'"></input>';
          $('.showimg2').html(img);
          $("#addimage2").val('');
          progress.hide();
        },
        error:function(xhr){ //上传失败
          //console.log(xhr.status)
        }
      });
    });
  });


$(function () {
    var progress = $(".img");
    var bar = $('.bar') ;
    var percent = $('.percent');
    var progress = $('.progress');
    $("#editimage2").wrap("<form id='myupload6' action='{:U('/Admin/Index/addImage')}' method='post' enctype='multipart/form-data'></form>");
    $("#editimage2").change(function(){ //选择文件
      $("#myupload6").ajaxSubmit({
        dataType:  'json', //数据格式为json
        beforeSend: function() { //开始上传
          progress.show(); //显示进度条
          var percentVal = '0%';
          bar.width(percentVal);
          percent.html(percentVal);
        },
        uploadProgress: function(event, position, total, percentComplete) {
          var percentVal = percentComplete + '%'; //获得进度
          bar.width(percentVal); //上传进度条宽度变宽
          percent.html(percentVal); //显示上传进度百分比
        },
        success: function(data) { //成功
          var img = '<img src="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'" width="80" height="56" style="margin-top:-28px;"><input type="hidden" name="pic1" id="editpic2" value="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'"></input>';
          $('.showimgedit2').html(img);
          $("#editimage2").val('');
          progress.hide();
        },
        error:function(xhr){ //上传失败
          //console.log(xhr.status)
        }
      });
    });
  });
</script> 
<script>

</script> 

<!--添加分类--> 

<script type="text/javascript">
    $(".BtnAddClass").click(function(){
        $('.addfenlei').show();
        $('#albums-overlay').show();
        $("#color").focus(function(){
          $("#picker").attr("style","display:block,position:absolute !important;");
        })
        $('#picker').colpick({
          flat:true,
          layout:'hex',
          submit:0
      });
    })
</script> 
<script type="text/javascript">
    $("#addcategory").click(function(){
      var classname = $('.classname').val();  //分类名称
      var fid = $('#fid').val();
      var check = $('input[name=is_recommend]').attr("checked");
      if(check =="checked"){
          var is_recommend = 1;
      }
      console.log(is_recommend);
		  var pic = $('#addpic').val();
      var sort = $('#addsort').val();           //排序
      var color = "#"+$('.colpick_hex_field').find('input').val();//背景色
      var pic1 = $('#addpic1').val();
      var pic2 = $('#addpic2').val();
      console.log(pic2);
        if (classname == '') {
            alert("分类名称必填！");
            return false;
        }

        if(!sort.match(/^[0-9]*$/)){
            alert("请填写正确的排序！");
            return false;
        }

        $.ajax({
            url: "{:U('/Admin/Fenxiao/addCate')}",
            type: "post",
            dataType: "json",
            data: {
                classname: classname,
        				fid:       fid,
                pic:       pic,
                pic1:      pic1,
        				pic2:      pic2,
                color:color,
                is_recommend:is_recommend,
                sort:      sort
            }
        }).done(function (g) {
            if (g.status == 1) {
                dialog.showTips(g.info,"firm",function(){
                	window.location.reload();
                });
            } else {
                alert(g.info);
            }

        })
    })
</script> 
<!--添加分类end--> 

<!--修改分类--> 
<script type="text/javascript">
    var categoryid;
    $(".j-editClass").click(function(){
        $('.editfenlei').show();
        $('#albums-overlay').show();
        $("#color1").focus(function(){
          $("#picker1").attr("style","display:block,position:absolute !important;");
        })

        $('#picker1').colpick({
          flat:true,
          layout:'hex',
          submit:0
      });

        var color  = $(this).attr('data-color');
        var categoryname=$(this).attr('data-title');
        var categorydescribe1=$(this).attr('data-describe1');
        var categorydescribe2=$(this).attr('data-describe2');
        var categorydescribe3=$(this).attr('data-describe3');
        var categorydescribe4=$(this).attr('data-describe4');

        //alert(categorydescribe1);

        var categoryid=$(this).attr('data-id');
	      var fid=$(this).attr('data-fid');
        var pic=$(this).attr('data-pic');
        var pic1=$(this).attr('data-pic1');
		    var pic2=$(this).attr('data-pic2');

        var sort=$(this).attr('data-renk');
        var is_recommend=$(this).attr('data-recommend');
        if(is_recommend==1){
           $('input[name=is_recommend1]').attr("checked",true);
        }
        $('#editclassname').val(categoryname);
        $('#editdescribe1').val(categorydescribe1);
        $('#editdescribe2').val(categorydescribe2);
        $('#editdescribe3').val(categorydescribe3);
        $('#editdescribe4').val(categorydescribe4);
		    $('#editfid').val(fid);
        $('#editsort').val(sort);
        $('#categoryid').val(categoryid);
        $("#color1").val(color);
        color = color.substr(1);
        $('.colpick_hex_field').find('input').val(color);
		if(pic!=""){

			var img = '<img src="'+pic+'" width="80" height="56" style="margin-top:-28px;background-color:#'+color+'"><input type="hidden" name="pic" id="editpic" value="'+pic+'"></input>';
			$('.showimgedit').html(img);

		}else{
			$('.showimgedit').html('');
		}

    if(pic1!=""){

      var img1 = '<img src="'+pic1+'" width="80" height="56" style="margin-top:-28px;"><input type="hidden" name="pic1" id="editpic1" value="'+pic1+'"></input>';
      $('.showimgedit1').html(img1);

    }else{
      $('.showimgedit1').html('');
    }

    if(pic2!=""){

      var img2 = '<img src="'+pic2+'" width="80" height="56" style="margin-top:-28px;"><input type="hidden" name="pic2" id="editpic2" value="'+pic2+'"></input>';
      $('.showimgedit2').html(img2);

    }else{
      $('.showimgedit2').html('');
    }

    })

    $("#editcategory").click(function(){
        var classname = $('#editclassname').val();  //分类名称
		    var fid = $('#editfid').val();  //分类名称
        var pic = $('#editpic').val();
        var pic1 = $('#editpic1').val();
        var pic2 = $('#editpic2').val();
		    var sort = $('#editsort').val();           //排序
        var categoryid = $('#categoryid').val();           //排序
        var color = "#"+$('.colpick_hex_field').find('input').val();//背景色
        var check = $('input[name=is_recommend1]').attr("checked");
        if(check =="checked"){
            var is_recommend = 1;
        }
      console.log(is_recommend);
        if (classname == '') {
            alert("分类名称必填！");
            return false;
        }
        $.ajax({
            url: "{:U('/Admin/Fenxiao/editCate')}",
            type: "post",
            dataType: "json",
            data: {
                classname: classname,
				        fid: fid,
                pic: pic,
                pic1: pic1,
				        pic2: pic2,
                sort: sort,
                is_recommend:is_recommend,
                categoryid:categoryid,
                color:color,
            }
        }).done(function (g) {
            if (g.status == 1) {
                 dialog.showTips(g.info,"firm",function(){
                	window.location.reload();
                 });

            } else {
                alert(g.info);
            }
        })
    })
</script> 
<!--修改分类end-->


<!--删除 1-->
<script>
    function btn_del(id){
        if(confirm('确定要删除吗？')){
            if(!id){
                var id ='';
                if($('.check:checked').length ==0){
                    alert('请选择要删除的数据');return false;
                }
                $('.check:checked').each(function(){
                    id = id + $(this).attr("data-id") + '_';
                });
            }
            $.ajax({
                url: "{:U('/Admin/Fenxiao/delCate')}",
                type: "post",
                dataType: "json",
                data: {
                    id: id
                }
            }).done(function (res) {
                if (res.status == 1) {
                    dialog.showTips(res.info, "warn", function (){
                        window.location.reload();
                    });
                } else {
                    dialog.showTips(res.info,"warn");
                }
            })
        }
    }
</script>

<!--删除 2-->
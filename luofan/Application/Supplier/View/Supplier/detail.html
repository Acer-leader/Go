<include file="Public:head"/>
<style>
    .imgnav{
        max-height: 30px;
        overflow: hidden;
        cursor: pointer;
    }
    .imgwrapper{
        display: block;
        width: 78px;
        height: 78px;
        overflow: hidden;
    }
    .imgwrapper img{
        display: block;
        width: 100%;
        padding: 0;
        margin: 0;
        border:0;
    }
    .spanpd10{
        margin:10px;
    }
    .wxtables.wxtables-sku.newtable{
        width: 40%;
        margin: 0;
    }
    .img-list li{
        width: 60px;
        height:60px;
    }
    .cst_h3 span{font-weight: normal;}
    #imgdiv img{ max-width:190px; max-height:190px; display:none; margin:5px;}
    .btnimage{width:80px; height:30px; background:white; border:1px solid #d9d9d9;cursor:pointer; position:relative; text-align:center; line-height:31px;}
    .file{ position:absolute; top:0px; left:0; width:80px; height:30px; background:white; border:1px solid #d9d9d9;cursor:pointer; opacity:0}
    #imgdiv2 img{ max-width:88px; max-height:88px; display:none; margin:5px;}
    #xuanze2{ width:60px; height:30px; background:white; border:1px solid #d9d9d9; }
    #xuanze2:hover{ background:#E6E6E6; }
    .huase{display:none; width:86px; height:30px; margin:5px; text-indent:5px;}
</style>
<div class="container">
    <div class="inner clearfix">
        <include file="Public:left"/>
        <!-- end content-left -->

        <div class="content-right fl">
            <h1 class="content-right-title">账户信息</h1>
            <form action="{:U('Supplier/Supplier/editmember')}"  method="post" onsubmit="return toVaild()">
                <input type="hidden" name="id" value="{$memberdetail['id']}">
                <div class="panel-single panel-single-light mgt20">
                    <h3 class="cst_h3 mgb20">基本信息</h3>
                    <div class="formitems">
                        <label class="fi-name"><span class="colorRed"></span>排序：</label>
                        <div class="form-controls">
                            <input type="text" class="input mini" name="sort" id="sort" value="{$memberdetail['sort']}" />
                        </div>
                    </div>
                    <div class="formitems">
                        <label class="fi-name">企业名称：</label>
                        <div class="form-controls">
                            <input type="text" class="input" value="{$memberdetail['username']}"  id="username" name="username" />
                            <span class="lh30 mgl10"></span>
                        </div>
                    </div>
                    <div class="formitems">
                        <label class="fi-name">固定电话：</label>
                        <div class="form-controls">
                            <input type="text" class="input" value="{$memberdetail['tel']}"  id="tel" name="tel" />
                            <span class="lh30 mgl10"></span>
                        </div>
                    </div>
                    <div class="formitems">
                        <label class="fi-name">联系人姓名：</label>
                        <div class="form-controls">
                            <input type="text" class="input" value="{$memberdetail.realname}"  id="realname" name="realname" />
                            <span class="lh30 mgl10"></span>
                        </div>
                    </div>
                    <div class="formitems">
                        <label class="fi-name">联系人手机号：</label>
                        <div class="form-controls">
                            <input type="text" class="input" value="{$memberdetail.telephone}"  id="telephone" name="telephone" />
                            <span class="lh30 mgl10"></span>
                        </div>
                    </div>
                    <div class="formitems">
                        <label class="fi-name">法人代表姓名：</label>
                        <div class="form-controls">
                            <input type="text" class="input" value="{$memberdetail.legal_personname}"  id="legal_personname" name="legal_personname" />
                            <span class="lh30 mgl10"></span>
                        </div>
                    </div>
                    <div class="formitems">
                        <label class="fi-name">法人代表手机号：</label>
                        <div class="form-controls">
                            <input type="text" class="input" value="{$memberdetail.legal_telephone}" id="legal_telephone" name="legal_telephone" />
                            <span class="lh30 mgl10"></span>
                        </div>
                    </div>
                    <div class="formitems">
                        <label class="fi-name">联系人身份证：</label>
                        <div class="form-controls">
                            <input type="text" class="input" value="{$memberdetail.id_card}" id="id_card" name="id_card" >
                            <span class="lh30 mgl10"></span>
                        </div>
                    </div>
                    <div class="formitems">
                        <label class="fi-name"><span class="colorRed">*</span>身份证正面照：</label>
                        <div class="form-controls pdt5 j-imglistPanel">
                            <div class="cart_z_showimge fl mgr10">
                                <img src="{$memberdetail['id_pic']}" height="80">
                            </div>
                            <div class="btnimage fl">选择图片
                                <input type="file"  accept="image/jpg,image/jpeg,image/png" name="serial" id="cart_z" class="file" >
                            </div>
                            <div class="xuanze_progress fl mgr15" style="display:none"><img src="__IMAGES__/loadings.gif" width="30" /><span class="cart_z">80%</span></div>
                            <span class="fi-help-text fl lh30 mgl10">建议大小（宽350px高264px）</span>
                        </div>
                    </div>
                    <div class="formitems">
                        <label class="fi-name"><span class="colorRed">*</span>身份证反面照：</label>
                        <div class="form-controls pdt5 j-imglistPanel">
                            <div class="cart_f_showimge fl mgr10">
                                <img src="{$memberdetail['id_pic1']}" height="80">
                            </div>
                            <div class="btnimage fl">选择图片
                                <input type="file"  accept="image/jpg,image/jpeg,image/png" name="serial" id="cart_f" class="file" >
                            </div>
                            <div class="xuanze_progress fl mgr15" style="display:none"><img src="__IMAGES__/loadings.gif" width="30" /><span class="cart_f">80%</span></div>
                            <span class="fi-help-text fl lh30 mgl10">建议大小（宽350px高264px）</span>
                        </div>
                    </div>


                    <div class="formitems">
                        <label class="fi-name"><span class="colorRed">*</span>营业执照扫描件：</label>
                        <div class="form-controls pdt5 j-imglistPanel">
                            <div class="zlicense_showimge fl mgr10">
                                <img src="{$memberdetail['license_pic']}" height="80">
                            </div>
                            <div class="btnimage fl">选择图片
                                <input type="file"  accept="image/jpg,image/jpeg,image/png" name="serial" id="zlicense" class="file" >
                            </div>
                            <div class="xuanze_progress fl mgr15" style="display:none"><img src="__IMAGES__/loadings.gif" width="30" /><span class="zlicense_pic">80%</span></div>
                            <span class="fi-help-text fl lh30 mgl10">建议大小（宽400px高270px）</span>
                        </div>
                    </div>
                    <div class="formitems">
                        <label class="fi-name"><span class="colorRed">*</span>营业执照扫描件：</label>
                        <div class="form-controls pdt5 j-imglistPanel">
                            <div class="flicense_showimge fl mgr10">
                                <img src="{$memberdetail['license_pic1']}" height="80">
                            </div>
                            <div class="btnimage fl">选择图片
                                <input type="file"  accept="image/jpg,image/jpeg,image/png" name="serial" id="flicense" class="file" >
                            </div>
                            <div class="xuanze_progress fl mgr15" style="display:none"><img src="__IMAGES__/loadings.gif" width="30" /><span class="flicense_pic">80%</span></div>
                            <span class="fi-help-text fl lh30 mgl10">建议大小（宽400px高270px）</span>
                        </div>
                    </div>


                </div>


        <div class="panel-single panel-single-light mgt20 j-showinhyd" style="display: block;">
            <h3 class="cst_h3 mgb20">企业描述</h3>
            <div class="formitems">
                <div class="form-controls">
                    <script id="editor" name="company_des" type="text/plain" style="width:200px;height:500px;">
                {$memberdetail['company_des']|htmlspecialchars_decode|stripslashes}
              </script>
                </div>
            </div>
        </div>


        <!-- end 详情及其它 -->
        <div class="panel-single panel-single-light mgt20 txtCenter">
            <a href="{:U('Supplier/Supplier/index')}" class="btn">取消</a>
            <input type="submit" class="btn btn-primary" value="保存">
        </div>
        </form>
    </div>
    <!-- end content-right -->
</div>
</div>
<!-- end container -->

<include file="Public:foot"/>


<!--选择分类-->
<script type="text/javascript">






    UE.getEditor('editor',{
        toolbars: [

            ['source', 'fontfamily','fontsize','bold','italic', 'underline','forecolor','redo','undo','insertunorderedlist','insertorderedlist','cleardoc', 'justifyleft','justifyright','justifycenter','justifyjustify','insertimage','inserttable','insertrow','insertcol', "mergeright", "mergedown", "deleterow", "deletecol", "splittorows", "splittocols", "splittocells", "deletecaption",  'inserttitle', 'mergecells', 'deletetable','cleardoc','insertparagraphbeforetable', 'edittable', 'edittd']

        ],

        autoHeightEnabled: false,
        autoFloatEnabled: true,
        elementPathEnabled:false,
        enableContextMenu:false,
        wordCount:false,

    });




</script>


<!--提交表单前验证-->
<script type="text/javascript">


    function toVaild(){

        var username=$('#username').val();
        var tel=$('#tel').val();
        var realname=$('#realname').val();
        var telephone=$('#telephone').val();
        var legal_personname=$('#legal_personname').val();
        var legal_telephone=$("#legal_telephone").val();
        var ID_cart=$('#id_card').val();
        var company_des=$("#editor").text();
        if(username==''||username==null){
            alert('请填写公司名称');
            return false;
        }
        if(tel==''||tel==null){
            alert('请填写固定电话');
            return false;
        }
        if(realname=='' || realname==null){
            alert('请填写联系人姓名222');
            $('#realname').focus();
            return false;
        }
        if(telephone=='' || telephone==null){
            alert('请填写联系人手机号');
            return false;
        }
        if(legal_personname=='' || legal_personname==null){
            alert('请填写法人姓名');
            return false;
        }
        if(legal_telephone=='' || legal_telephone==null){
            alert('请填写法人手机号');
            return false;
        }
        if(ID_cart=='' || ID_cart==null){
            alert('请填写身份证号码');
            return false;
        }

        if(company_des==''||company_des==null){
            alert('请填写公司描述');
            return false;
        }
        return true;

    }
</script>
<!--提交表单前验证end

<!--上传图片-->

<script type="text/javascript" src="__JS__/jquery.js"></script>
<script type="text/javascript" src="__JS__/uploadPreview.min.js"></script>

<script type="text/javascript" src="__JS__/jquery-form.js"></script>
<script type="text/javascript">

    function delImg(obj){
        if(!confirm("删除这张图片？")){
            return false;
        }
        var id = $(obj).attr("data-id")
        if(id){
            $.post("{:U('Supplier/Goods/delGoodsSlide')}", {id:id}, function (data){
                if(data.status==1){
                    $(obj).remove();
                }else{
                    alert(data.info);
                }
            }, "json")
            return false;
        }
        $(obj).next("input").remove();
        $(obj).remove();
    }
    $(function () {
        var percent = $('.cart_z');
        var progress = $('.cart_z');
        $("#cart_z").wrap("<form id='myupload1' action='{:U('/supplier/Index/addImage')}' method='post' enctype='multipart/form-data'></form>");
        $("#cart_z").change(function(){ //选择文件
            $("#myupload1").ajaxSubmit({
                dataType:  'json', //数据格式为json
                beforeSend: function() { //开始上传
                    progress.show(); //显示进度条
                    var percentVal = '0%';
                    percent.html(percentVal);
                },
                uploadProgress: function(event, position, total, percentComplete) {
                    var percentVal = percentComplete + '%'; //获得进度
                    percent.html(percentVal); //显示上传进度百分比
                },
                success: function(data) { //成功
                    var img = '<img src="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'" height="80" ><input type="hidden" name="cart_zpic" id="zpic" value="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'" />';
                    $('.cart_z_showimge').html(img);
                    progress.hide();
                },
                error:function(xhr){ //上传失败
                    //console.log(xhr.status)
                }
            });
        });


        var percent = $('.cart_f');
        var progress = $('.cart_f');
        $("#cart_f").wrap("<form id='myupload' action='{:U('/supplier/Index/addImage')}' method='post' enctype='multipart/form-data'></form>");
        $("#cart_f").change(function(){ //选择文件
            $("#myupload").ajaxSubmit({
                dataType:  'json', //数据格式为json
                beforeSend: function() { //开始上传
                    progress.show(); //显示进度条
                    var percentVal = '0%';
                    percent.html(percentVal);
                },
                uploadProgress: function(event, position, total, percentComplete) {
                    var percentVal = percentComplete + '%'; //获得进度
                    percent.html(percentVal); //显示上传进度百分比
                },
                success: function(data) { //成功
                    var img = '<img src="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'" height="80"  class="mgr10 mgt10 " onclick="delImg(this)"><input type="hidden" name="cart_fpic" id="fpic" value="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'" />';
                    console.log(img);
                    $('.cart_f_showimge').html(img);
                    progress.hide();
                },
                error:function(xhr){ //上传失败
                    //console.log(xhr.status)
                }
            });
        });

        var percent = $('.zlicense');
        var progress = $('.zlicense');
        $("#zlicense").wrap("<form id='baotuan1' action='{:U('/supplier/Index/addImage')}' method='post' enctype='multipart/form-data'></form>");
        $("#zlicense").change(function(){ //选择文件
            $("#baotuan1").ajaxSubmit({
                dataType:  'json', //数据格式为json
                beforeSend: function() { //开始上传
                    progress.show(); //显示进度条
                    var percentVal = '0%';
                    percent.html(percentVal);
                },
                uploadProgress: function(event, position, total, percentComplete) {
                    var percentVal = percentComplete + '%'; //获得进度
                    percent.html(percentVal); //显示上传进度百分比
                },
                success: function(data) { //成功
                    var img = '<img src="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'" height="80" ><input type="hidden" name="license_zpic" id="lis_zpic" value="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'" />';
                    $('.zlicense_showimge').html(img);
                    progress.hide();
                },
                error:function(xhr){ //上传失败
                    //console.log(xhr.status)
                }
            });
        });

        var percent = $('.flicense');
        var progress = $('.flicense');
        $("#flicense").wrap("<form id='baotuan2' action='{:U('/supplier/Index/addImage')}' method='post' enctype='multipart/form-data'></form>");
        $("#flicense").change(function(){ //选择文件
            $("#baotuan2").ajaxSubmit({
                dataType:  'json', //数据格式为json
                beforeSend: function() { //开始上传
                    progress.show(); //显示进度条
                    var percentVal = '0%';
                    percent.html(percentVal);
                },
                uploadProgress: function(event, position, total, percentComplete) {
                    var percentVal = percentComplete + '%'; //获得进度
                    percent.html(percentVal); //显示上传进度百分比
                },
                success: function(data) { //成功
                    var img = '<img src="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'" height="80" ><input type="hidden" name="license_fpic" id="lis_fpic" value="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'" />';
                    $('.flicense_showimge').html(img);
                    progress.hide();
                },
                error:function(xhr){ //上传失败
                    //console.log(xhr.status)
                }
            });
        });

    });

</script>
<!--上传图片-end->


